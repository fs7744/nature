worker_processes: 1
enable_reuseport: true
events_sock: unix:/tmp/event.sock
dns:
  enable_ipv6: false
  timeout: 500
  validTtl: 60000
  retrans: 1
  nameservers:
    - 6.6.6.6
discovery:
  - dns
plugins:
  stream:
    - nature.plugins.single_upstream
stream:
  enable: true
  access_log:
    enable: true
    format: "$remote_addr [$time_local] $protocol $status $bytes_sent $bytes_received $session_time $hostname $server_addr"
router:
  l4:
    r1:
      host:
        - *
      listen: 127.0.0.1:8980
      type: tcp
      ssl: false
      upstream: a
      preread:
        - name: nature.plugins.single_upstream
upstream:
  a:
    type: dns
    nodes:
      - host: www.google.com
        port: 80
        weight: 1